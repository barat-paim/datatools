# Problem - 001 (compiler_1.py)
*The Data Validation Problem*

How to know if the API response contains all the expected fields and the correct number of records based on the "total" field in the JSON.

# Solution
(1) Set Up Validation to Ensure Data is Complete

We want to check if the API response contains:
	â€¢	All expected fields in each row.
	â€¢	The correct number of records based on the "total" field in the JSON.

âœ… Solution: Validate Data Completeness

Modify the script to check if all fields exist and compare the row count with "total".

def validate_completeness(data, schema):
    """Validate if the extracted data is complete."""
    expected_total = int(data.get("MRData", {}).get("total", 0))  # Expected total from API
    actual_total = len(data.get("MRData", {}).get("CircuitTable", {}).get("Circuits", []))  # Count of extracted rows

    # Validate row count
    if actual_total == expected_total:
        print(f"âœ… Data contains the expected {actual_total} records.")
    else:
        print(f"âš ï¸ Data is incomplete: Expected {expected_total}, but got {actual_total}.")

    # Validate that all required fields are present in every row
    required_fields = ["circuitId", "url", "circuitName", "Location"]
    missing_rows = [row for row in data["MRData"]["CircuitTable"]["Circuits"]
                    if any(field not in row for field in required_fields)]

    if missing_rows:
        print(f"âŒ {len(missing_rows)} rows are missing required fields.")
    else:
        print("âœ… All rows contain the required fields.")

# After fetching the API data
validate_completeness(data, schema)

ğŸ”¹ Example Output (If Data is Complete)

âœ… Data contains the expected 76 records.
âœ… All rows contain the required fields.

ğŸ”¹ Example Output (If Data is Incomplete)

âš ï¸ Data is incomplete: Expected 76, but got 72.
âŒ 3 rows are missing required fields.

ğŸš€ Final Summary

âœ… See Full Table â€“ Use pd.set_option() to show all rows and columns.
âœ… Validate Completeness â€“ Compare extracted records with "total" and check for missing fields.

This ensures full visibility and data integrity when fetching APIs dynamically. ğŸš€